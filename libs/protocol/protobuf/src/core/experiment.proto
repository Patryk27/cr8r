syntax = "proto3";

package cr8r.core;

message Experiment {
    message Status {
        message AwaitingRunner {
            string since = 1;
        }

        message Completed {
            string since = 1;
        }

        message Running {
            string since = 1;
            string runner_id = 2;
            uint32 completed_scenarios = 3;
            uint32 total_scenarios = 4;
        }

        message Zombie {
            string since = 1;
        }

        oneof op {
            AwaitingRunner awaiting_runner = 1;
            Completed completed = 2;
            Running running = 3;
            Zombie zombie = 4;
        }
    }

    string id = 1;
    string created_at = 2;
    string heartbeaten_at = 3;
    Status status = 4;
}

message ExperimentDefinition {
    message TrySystem {
        string system = 1;
    }

    message TryToolchain {
        string toolchain = 1;
    }

    oneof experiment_definition_inner {
        TrySystem try_system = 1;
        TryToolchain try_toolchain = 2;
    }
}